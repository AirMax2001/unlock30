(()=>{"use strict";var e={34:(e,a,s)=>{var i=s(751),n=s(641);const c={id:"app"};function l(e,a,s,i,l,t){const o=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",c,[(0,n.bF)(o)])}const t={name:"App"};var o=s(262);const r=(0,o.A)(t,[["render",l]]),d=r;var u=s(220),h=s(33);const m={class:"home-container"},g={class:"main-content"},v={class:"play-section"},k={class:"modal-header"},p={class:"modal-body"},f={class:"form-group"},L={class:"form-group"},S={key:0,class:"error-message"},C={class:"modal-footer"},b=["disabled"],y={key:0,class:"fas fa-spinner fa-spin"};function E(e,a,s,c,l,t){return(0,n.uX)(),(0,n.CE)("div",m,[(0,n.Lk)("button",{class:"admin-btn",onClick:a[0]||(a[0]=e=>l.showLoginModal=!0)},[...a[11]||(a[11]=[(0,n.Lk)("i",{class:"fas fa-cog"},null,-1),(0,n.eW)(" Admin ",-1)])]),(0,n.Lk)("div",g,[a[13]||(a[13]=(0,n.Lk)("div",{class:"game-title"},[(0,n.Lk)("h1",{class:"title-text"},"Il Gioco dei Trenta"),(0,n.Lk)("p",{class:"subtitle"},"Un'avventura interattiva che ti aspetta")],-1)),(0,n.Lk)("div",v,[(0,n.Lk)("button",{class:"play-btn",onClick:a[1]||(a[1]=(...e)=>t.startGame&&t.startGame(...e))},[...a[12]||(a[12]=[(0,n.Lk)("i",{class:"fas fa-play"},null,-1),(0,n.Lk)("span",null,"Avvia Gioco",-1)])])]),a[14]||(a[14]=(0,n.Fv)('<div class="decorative-elements" data-v-502d2527><div class="floating-icon icon-1" data-v-502d2527><i class="fas fa-star" data-v-502d2527></i></div><div class="floating-icon icon-2" data-v-502d2527><i class="fas fa-gem" data-v-502d2527></i></div><div class="floating-icon icon-3" data-v-502d2527><i class="fas fa-crown" data-v-502d2527></i></div><div class="floating-icon icon-4" data-v-502d2527><i class="fas fa-magic" data-v-502d2527></i></div></div>',1))]),l.showLoginModal?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"modal-overlay",onClick:a[10]||(a[10]=(...e)=>t.closeModal&&t.closeModal(...e))},[(0,n.Lk)("div",{class:"modal-content",onClick:a[9]||(a[9]=(0,i.D$)(()=>{},["stop"]))},[(0,n.Lk)("div",k,[a[16]||(a[16]=(0,n.Lk)("h3",null,"Accesso Admin",-1)),(0,n.Lk)("button",{class:"close-btn",onClick:a[2]||(a[2]=(...e)=>t.closeModal&&t.closeModal(...e))},[...a[15]||(a[15]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)])])]),(0,n.Lk)("div",p,[(0,n.Lk)("div",f,[a[17]||(a[17]=(0,n.Lk)("label",null,"Username:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>l.loginForm.username=e),placeholder:"Inserisci username",onKeyup:a[4]||(a[4]=(0,i.jR)((...e)=>t.adminLogin&&t.adminLogin(...e),["enter"]))},null,544),[[i.Jo,l.loginForm.username]])]),(0,n.Lk)("div",L,[a[18]||(a[18]=(0,n.Lk)("label",null,"Password:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>l.loginForm.password=e),placeholder:"Inserisci password",onKeyup:a[6]||(a[6]=(0,i.jR)((...e)=>t.adminLogin&&t.adminLogin(...e),["enter"]))},null,544),[[i.Jo,l.loginForm.password]])]),l.loginError?((0,n.uX)(),(0,n.CE)("div",S,(0,h.v_)(l.loginError),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",C,[(0,n.Lk)("button",{class:"btn-cancel",onClick:a[7]||(a[7]=(...e)=>t.closeModal&&t.closeModal(...e))},"Annulla"),(0,n.Lk)("button",{class:"btn-login",onClick:a[8]||(a[8]=(...e)=>t.adminLogin&&t.adminLogin(...e)),disabled:l.isLogging},[l.isLogging?((0,n.uX)(),(0,n.CE)("i",y)):(0,n.Q3)("",!0),(0,n.eW)(" "+(0,h.v_)(l.isLogging?"Accesso...":"Accedi"),1)],8,b)])])])):(0,n.Q3)("",!0)])}var I=s(335);const w={name:"Home",data(){return{showLoginModal:!1,loginForm:{username:"",password:""},loginError:"",isLogging:!1}},methods:{startGame(){this.$router.push("/game")},closeModal(){this.showLoginModal=!1,this.loginForm={username:"",password:""},this.loginError=""},async adminLogin(){if(this.loginForm.username&&this.loginForm.password){this.isLogging=!0,this.loginError="";try{const e=await I.A.post("/api/admin/login",this.loginForm);e.data.success&&(localStorage.setItem("adminAuth","true"),this.$router.push("/admin"))}catch(e){this.loginError=e.response?.data?.message||"Errore di accesso"}finally{this.isLogging=!1}}else this.loginError="Inserisci username e password"}}},F=(0,o.A)(w,[["render",E],["__scopeId","data-v-502d2527"]]),T=F,A={class:"game-container"},_={class:"game-header"},X={key:0,class:"loading-container"},D={key:1,class:"error-container"},N={key:2,class:"game-content"},x={class:"scene-container"},O={class:"scene-header"},R={class:"scene-title"},U={key:0,class:"final-indicator"},W={key:0,class:"media-container"},G=["src","alt"],V=["src"],M={class:"description-container"},Q={class:"description-box"},$={class:"scene-description"},P={key:1,class:"choices-container"},z={class:"choices-grid"},j=["onClick","disabled"],H={class:"choice-text"},J={key:2,class:"game-end"},K={class:"end-message"};function B(e,a,s,i,c,l){return(0,n.uX)(),(0,n.CE)("div",A,[(0,n.Lk)("div",_,[(0,n.Lk)("button",{class:"back-btn",onClick:a[0]||(a[0]=(...e)=>l.goHome&&l.goHome(...e))},[...a[3]||(a[3]=[(0,n.Lk)("i",{class:"fas fa-arrow-left"},null,-1),(0,n.eW)(" Torna alla Home ",-1)])]),a[4]||(a[4]=(0,n.Lk)("h2",{class:"game-title"},"Il Gioco dei Trenta",-1))]),c.loading?((0,n.uX)(),(0,n.CE)("div",X,[...a[5]||(a[5]=[(0,n.Lk)("div",{class:"spinner"},null,-1),(0,n.Lk)("p",null,"Caricamento del gioco...",-1)])])):c.error?((0,n.uX)(),(0,n.CE)("div",D,[a[7]||(a[7]=(0,n.Lk)("i",{class:"fas fa-exclamation-triangle"},null,-1)),a[8]||(a[8]=(0,n.Lk)("h3",null,"Ops! Qualcosa è andato storto",-1)),(0,n.Lk)("p",null,(0,h.v_)(c.error),1),(0,n.Lk)("button",{class:"retry-btn",onClick:a[1]||(a[1]=(...e)=>l.loadGameData&&l.loadGameData(...e))},[...a[6]||(a[6]=[(0,n.Lk)("i",{class:"fas fa-redo"},null,-1),(0,n.eW)(" Riprova ",-1)])])])):c.currentScene?((0,n.uX)(),(0,n.CE)("div",N,[(0,n.Lk)("div",x,[(0,n.Lk)("div",O,[(0,n.Lk)("h1",R,[(0,n.eW)((0,h.v_)(c.currentScene.title)+" ",1),c.currentScene.isFinal?((0,n.uX)(),(0,n.CE)("span",U,[...a[9]||(a[9]=[(0,n.Lk)("i",{class:"fas fa-flag-checkered"},null,-1)])])):(0,n.Q3)("",!0)])]),c.currentScene.image||c.currentScene.video?((0,n.uX)(),(0,n.CE)("div",W,[c.currentScene.image?((0,n.uX)(),(0,n.CE)("img",{key:0,src:l.getMediaUrl(c.currentScene.image),alt:c.currentScene.title,class:"scene-image"},null,8,G)):(0,n.Q3)("",!0),c.currentScene.video?((0,n.uX)(),(0,n.CE)("video",{key:1,src:l.getMediaUrl(c.currentScene.video),controls:"",class:"scene-video"}," Il tuo browser non supporta i video. ",8,V)):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0),(0,n.Lk)("div",M,[(0,n.Lk)("div",Q,[(0,n.Lk)("p",$,(0,h.v_)(c.currentScene.description),1)])]),c.currentScene.choices&&c.currentScene.choices.length>0&&!c.currentScene.isFinal?((0,n.uX)(),(0,n.CE)("div",P,[a[11]||(a[11]=(0,n.Lk)("h3",{class:"choices-title"},"Cosa vuoi fare?",-1)),(0,n.Lk)("div",z,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.currentScene.choices,e=>((0,n.uX)(),(0,n.CE)("button",{key:e.id,onClick:a=>l.makeChoice(e),class:"choice-btn",disabled:c.processingChoice},[(0,n.Lk)("span",H,(0,h.v_)(e.text),1),a[10]||(a[10]=(0,n.Lk)("i",{class:"fas fa-arrow-right choice-arrow"},null,-1))],8,j))),128))])])):(0,n.Q3)("",!0),!c.currentScene.choices||0===c.currentScene.choices.length||c.currentScene.isFinal?((0,n.uX)(),(0,n.CE)("div",J,[(0,n.Lk)("div",K,[a[13]||(a[13]=(0,n.Lk)("i",{class:"fas fa-flag-checkered"},null,-1)),a[14]||(a[14]=(0,n.Lk)("h3",null,"Fine dell'avventura!",-1)),a[15]||(a[15]=(0,n.Lk)("p",null,'Grazie per aver giocato a "Il Gioco dei Trenta"',-1)),(0,n.Lk)("button",{class:"restart-btn",onClick:a[2]||(a[2]=(...e)=>l.restartGame&&l.restartGame(...e))},[...a[12]||(a[12]=[(0,n.Lk)("i",{class:"fas fa-redo"},null,-1),(0,n.eW)(" Ricomincia ",-1)])])])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)])}const q={development:{API_BASE_URL:"http://localhost:3001"},production:{API_BASE_URL:"http://maristellacichella.altervista.org"}},Y="localhost"===window.location.hostname?"development":"production",Z=q[Y],ee={name:"Game",data(){return{gameData:null,currentScene:null,currentSceneId:1,loading:!0,error:null,processingChoice:!1}},mounted(){this.loadGameData()},methods:{async loadGameData(){this.loading=!0,this.error=null;try{const e=await I.A.get("/api/game/data");this.gameData=e.data,this.loadScene(1)}catch(e){this.error="Impossibile caricare i dati del gioco. Assicurati che il server sia in esecuzione.",console.error("Errore nel caricamento:",e)}finally{this.loading=!1}},loadScene(e){if(!this.gameData||!this.gameData.scenes)return void(this.error="Dati del gioco non validi");const a=this.gameData.scenes.find(a=>a.id===e);a?(this.currentScene=a,this.currentSceneId=e):this.error=`Scena ${e} non trovata`},async makeChoice(e){e.nextSceneId?(this.processingChoice=!0,await new Promise(e=>setTimeout(e,500)),this.loadScene(e.nextSceneId),this.processingChoice=!1):this.currentScene={...this.currentScene,choices:[]}},restartGame(){this.currentSceneId=1,this.loadScene(1)},goHome(){this.$router.push("/")},getMediaUrl(e){return e?e.startsWith("http")?e:`${Z.API_BASE_URL}${e}`:""}}},ae=(0,o.A)(ee,[["render",B],["__scopeId","data-v-04742108"]]),se=ae,ie={class:"admin-container"},ne={class:"admin-header"},ce={class:"header-actions"},le={key:0,class:"loading-container"},te={key:1,class:"admin-content"},oe={class:"sidebar"},re={class:"sidebar-section"},de={class:"scenes-list"},ue=["onClick"],he={class:"scene-info"},me={key:0,class:"final-badge"},ge=["onClick"],ve={class:"main-editor"},ke={key:0,class:"no-selection"},pe={key:1,class:"scene-editor"},fe={class:"editor-header"},Le={class:"scene-header-info"},Se={class:"scene-id-badge"},Ce={class:"id-number"},be={class:"editor-actions"},ye=["disabled"],Ee={key:0,class:"fas fa-spinner fa-spin"},Ie={key:1,class:"fas fa-save"},we={class:"editor-content"},Fe={class:"form-section"},Te={class:"form-group"},Ae={class:"form-group"},_e={class:"form-section"},Xe={class:"media-upload"},De={class:"upload-section"},Ne={class:"upload-area"},xe={key:0,class:"current-media"},Oe=["src"],Re={class:"upload-section"},Ue={class:"upload-area"},We={key:0,class:"current-media"},Ge=["src"],Ve={key:0,class:"form-section"},Me={class:"scene-overview"},Qe={class:"available-scenes"},$e={class:"scenes-grid"},Pe={class:"chip-id"},ze={class:"chip-title"},je={key:0,class:"fas fa-flag-checkered final-icon"},He={class:"choices-editor"},Je={class:"choice-number"},Ke={class:"choice-text-section"},Be=["onUpdate:modelValue"],qe={class:"choice-controls"},Ye={class:"scene-selector"},Ze={class:"available-ids"},ea=["onClick","title"],aa={key:0,class:"fas fa-flag-checkered"},sa={class:"destination-input"},ia={class:"destination-box"},na=["onUpdate:modelValue"],ca={key:0,class:"destination-info"},la={key:0,class:"valid-destination"},ta={key:1,class:"invalid-destination"},oa=["onClick"],ra={key:1,class:"form-section final-scene-info"};function da(e,a,s,c,l,t){return(0,n.uX)(),(0,n.CE)("div",ie,[(0,n.Lk)("div",ne,[a[16]||(a[16]=(0,n.Lk)("h1",null,[(0,n.Lk)("i",{class:"fas fa-cog"}),(0,n.eW)(" Pannello Admin")],-1)),(0,n.Lk)("div",ce,[(0,n.Lk)("button",{class:"btn-preview",onClick:a[0]||(a[0]=(...e)=>t.previewGame&&t.previewGame(...e))},[...a[14]||(a[14]=[(0,n.Lk)("i",{class:"fas fa-eye"},null,-1),(0,n.eW)(" Anteprima Gioco ",-1)])]),(0,n.Lk)("button",{class:"btn-home",onClick:a[1]||(a[1]=(...e)=>t.goHome&&t.goHome(...e))},[...a[15]||(a[15]=[(0,n.Lk)("i",{class:"fas fa-home"},null,-1),(0,n.eW)(" Home ",-1)])])])]),l.loading?((0,n.uX)(),(0,n.CE)("div",le,[...a[17]||(a[17]=[(0,n.Lk)("div",{class:"spinner"},null,-1),(0,n.Lk)("p",null,"Caricamento pannello admin...",-1)])])):((0,n.uX)(),(0,n.CE)("div",te,[(0,n.Lk)("div",oe,[(0,n.Lk)("div",re,[a[19]||(a[19]=(0,n.Lk)("h3",null,"Gestione Scene",-1)),(0,n.Lk)("button",{class:"btn-add-scene",onClick:a[2]||(a[2]=(...e)=>t.addNewScene&&t.addNewScene(...e))},[...a[18]||(a[18]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Nuova Scena ",-1)])])]),(0,n.Lk)("div",de,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.scenes,e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,onClick:a=>t.selectScene(e),class:(0,h.C4)(["scene-item",{active:l.selectedScene?.id===e.id,final:e.isFinal}])},[(0,n.Lk)("div",he,[(0,n.Lk)("h4",null,(0,h.v_)(e.title||"Scena senza titolo"),1),(0,n.Lk)("p",null,"ID: "+(0,h.v_)(e.id),1),e.isFinal?((0,n.uX)(),(0,n.CE)("span",me,[...a[20]||(a[20]=[(0,n.Lk)("i",{class:"fas fa-flag-checkered"},null,-1),(0,n.eW)(" Finale ",-1)])])):(0,n.Q3)("",!0)]),(0,n.Lk)("button",{onClick:(0,i.D$)(a=>t.deleteScene(e.id),["stop"]),class:"btn-delete"},[...a[21]||(a[21]=[(0,n.Lk)("i",{class:"fas fa-trash"},null,-1)])],8,ge)],10,ue))),128))])]),(0,n.Lk)("div",ve,[l.selectedScene?((0,n.uX)(),(0,n.CE)("div",pe,[(0,n.Lk)("div",fe,[(0,n.Lk)("div",Le,[(0,n.Lk)("div",Se,[a[23]||(a[23]=(0,n.Lk)("span",{class:"id-label"},"ID:",-1)),(0,n.Lk)("span",Ce,(0,h.v_)(l.selectedScene.id),1)]),(0,n.Lk)("h2",null,(0,h.v_)(l.selectedScene.title||"Senza titolo"),1)]),(0,n.Lk)("div",be,[(0,n.Lk)("button",{onClick:a[3]||(a[3]=(...e)=>t.toggleFinalScene&&t.toggleFinalScene(...e)),class:(0,h.C4)(["btn-final",{active:l.selectedScene.isFinal}])},[a[24]||(a[24]=(0,n.Lk)("i",{class:"fas fa-flag-checkered"},null,-1)),(0,n.eW)(" "+(0,h.v_)(l.selectedScene.isFinal?"Scena Finale":"Rendi Finale"),1)],2),(0,n.Lk)("button",{onClick:a[4]||(a[4]=(...e)=>t.saveScene&&t.saveScene(...e)),class:"btn-save",disabled:l.saving},[l.saving?((0,n.uX)(),(0,n.CE)("i",Ee)):((0,n.uX)(),(0,n.CE)("i",Ie)),(0,n.eW)(" "+(0,h.v_)(l.saving?"Salvataggio...":"Salva"),1)],8,ye)])]),(0,n.Lk)("div",we,[(0,n.Lk)("div",Fe,[a[27]||(a[27]=(0,n.Lk)("h3",null,"Informazioni Base",-1)),(0,n.Lk)("div",Te,[a[25]||(a[25]=(0,n.Lk)("label",null,"Titolo della Scena:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":a[5]||(a[5]=e=>l.selectedScene.title=e),placeholder:"Inserisci il titolo della scena"},null,512),[[i.Jo,l.selectedScene.title]])]),(0,n.Lk)("div",Ae,[a[26]||(a[26]=(0,n.Lk)("label",null,"Descrizione:",-1)),(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":a[6]||(a[6]=e=>l.selectedScene.description=e),placeholder:"Inserisci la descrizione della scena",rows:"4"},null,512),[[i.Jo,l.selectedScene.description]])])]),(0,n.Lk)("div",_e,[a[34]||(a[34]=(0,n.Lk)("h3",null,"Media",-1)),(0,n.Lk)("div",Xe,[(0,n.Lk)("div",De,[a[30]||(a[30]=(0,n.Lk)("label",null,"Immagine:",-1)),(0,n.Lk)("div",Ne,[(0,n.Lk)("input",{type:"file",onChange:a[7]||(a[7]=(...e)=>t.uploadImage&&t.uploadImage(...e)),accept:"image/*",ref:"imageInput",style:{display:"none"}},null,544),(0,n.Lk)("button",{onClick:a[8]||(a[8]=a=>e.$refs.imageInput.click()),class:"btn-upload"},[...a[28]||(a[28]=[(0,n.Lk)("i",{class:"fas fa-image"},null,-1),(0,n.eW)(" Carica Immagine ",-1)])]),l.selectedScene.image?((0,n.uX)(),(0,n.CE)("div",xe,[(0,n.Lk)("img",{src:t.getMediaUrl(l.selectedScene.image),alt:"Anteprima",class:"media-preview"},null,8,Oe),(0,n.Lk)("button",{onClick:a[9]||(a[9]=(...e)=>t.removeImage&&t.removeImage(...e)),class:"btn-remove"},[...a[29]||(a[29]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,n.Q3)("",!0)])]),(0,n.Lk)("div",Re,[a[33]||(a[33]=(0,n.Lk)("label",null,"Video:",-1)),(0,n.Lk)("div",Ue,[(0,n.Lk)("input",{type:"file",onChange:a[10]||(a[10]=(...e)=>t.uploadVideo&&t.uploadVideo(...e)),accept:"video/*",ref:"videoInput",style:{display:"none"}},null,544),(0,n.Lk)("button",{onClick:a[11]||(a[11]=a=>e.$refs.videoInput.click()),class:"btn-upload"},[...a[31]||(a[31]=[(0,n.Lk)("i",{class:"fas fa-video"},null,-1),(0,n.eW)(" Carica Video ",-1)])]),l.selectedScene.video?((0,n.uX)(),(0,n.CE)("div",We,[(0,n.Lk)("video",{src:t.getMediaUrl(l.selectedScene.video),class:"media-preview",controls:""},null,8,Ge),(0,n.Lk)("button",{onClick:a[12]||(a[12]=(...e)=>t.removeVideo&&t.removeVideo(...e)),class:"btn-remove"},[...a[32]||(a[32]=[(0,n.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,n.Q3)("",!0)])])])]),l.selectedScene.isFinal?((0,n.uX)(),(0,n.CE)("div",ra,[...a[44]||(a[44]=[(0,n.Lk)("h3",null,[(0,n.Lk)("i",{class:"fas fa-flag-checkered"}),(0,n.eW)(" Scena Finale")],-1),(0,n.Lk)("div",{class:"final-message"},[(0,n.Lk)("p",null,[(0,n.Lk)("i",{class:"fas fa-info-circle"}),(0,n.eW)(" Questa è una scena finale. I giocatori che raggiungono questa scena vedranno il messaggio di fine gioco.")]),(0,n.Lk)("p",null,'Non è possibile aggiungere scelte a una scena finale. Se vuoi continuare la storia, disattiva prima l\'opzione "Scena Finale".')],-1)])])):((0,n.uX)(),(0,n.CE)("div",Ve,[a[43]||(a[43]=(0,n.Lk)("h3",null,"Scelte e Collegamenti",-1)),(0,n.Lk)("div",Me,[(0,n.Lk)("div",Qe,[a[35]||(a[35]=(0,n.Lk)("h4",null,"Scene Disponibili:",-1)),(0,n.Lk)("div",$e,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.scenes,e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:(0,h.C4)(["scene-chip",{current:e.id===l.selectedScene.id,final:e.isFinal}])},[(0,n.Lk)("span",Pe,(0,h.v_)(e.id),1),(0,n.Lk)("span",ze,(0,h.v_)(e.title||"Senza titolo"),1),e.isFinal?((0,n.uX)(),(0,n.CE)("i",je)):(0,n.Q3)("",!0)],2))),128))])])]),(0,n.Lk)("div",He,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.selectedScene.choices,(e,s)=>((0,n.uX)(),(0,n.CE)("div",{key:e.id||s,class:"choice-item-enhanced"},[(0,n.Lk)("div",Je,(0,h.v_)(s+1),1),(0,n.Lk)("div",Ke,[a[36]||(a[36]=(0,n.Lk)("label",null,"Testo della scelta:",-1)),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":a=>e.text=a,placeholder:"Inserisci il testo della scelta...",class:"choice-text-input-enhanced"},null,8,Be),[[i.Jo,e.text]])]),(0,n.Lk)("div",qe,[(0,n.Lk)("div",Ye,[a[37]||(a[37]=(0,n.Lk)("label",null,"Scene disponibili:",-1)),(0,n.Lk)("div",Ze,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.scenes.filter(e=>e.id!==l.selectedScene.id),a=>((0,n.uX)(),(0,n.CE)("span",{key:a.id,onClick:s=>t.setChoiceDestination(e,a.id),class:(0,h.C4)(["id-chip",{selected:e.nextSceneId===a.id,final:a.isFinal}]),title:a.title},[(0,n.eW)((0,h.v_)(a.id)+" ",1),a.isFinal?((0,n.uX)(),(0,n.CE)("i",aa)):(0,n.Q3)("",!0)],10,ea))),128))])]),(0,n.Lk)("div",sa,[a[40]||(a[40]=(0,n.Lk)("label",null,"Vai alla scena:",-1)),(0,n.Lk)("div",ia,[(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":a=>e.nextSceneId=a,placeholder:"ID",class:(0,h.C4)(["destination-number",{invalid:e.nextSceneId&&!t.isValidSceneId(e.nextSceneId),valid:e.nextSceneId&&t.isValidSceneId(e.nextSceneId)}])},null,10,na),[[i.Jo,e.nextSceneId,void 0,{number:!0}]]),e.nextSceneId?((0,n.uX)(),(0,n.CE)("div",ca,[t.isValidSceneId(e.nextSceneId)?((0,n.uX)(),(0,n.CE)("span",la,[a[38]||(a[38]=(0,n.Lk)("i",{class:"fas fa-check"},null,-1)),(0,n.eW)(" "+(0,h.v_)(t.getSceneTitle(e.nextSceneId)),1)])):((0,n.uX)(),(0,n.CE)("span",ta,[...a[39]||(a[39]=[(0,n.Lk)("i",{class:"fas fa-exclamation-triangle"},null,-1),(0,n.eW)(" Scena non trovata ",-1)])]))])):(0,n.Q3)("",!0)])])]),(0,n.Lk)("button",{onClick:e=>t.removeChoice(s),class:"btn-remove-choice-enhanced"},[...a[41]||(a[41]=[(0,n.Lk)("i",{class:"fas fa-trash"},null,-1)])],8,oa)]))),128)),(0,n.Lk)("button",{onClick:a[13]||(a[13]=(...e)=>t.addChoice&&t.addChoice(...e)),class:"btn-add-choice"},[...a[42]||(a[42]=[(0,n.Lk)("i",{class:"fas fa-plus"},null,-1),(0,n.eW)(" Aggiungi Scelta ",-1)])])])]))])])):((0,n.uX)(),(0,n.CE)("div",ke,[...a[22]||(a[22]=[(0,n.Lk)("i",{class:"fas fa-mouse-pointer"},null,-1),(0,n.Lk)("h3",null,"Seleziona una scena per modificarla",-1),(0,n.Lk)("p",null,'Oppure crea una nuova scena cliccando su "Nuova Scena"',-1)])]))])])),l.toast.show?((0,n.uX)(),(0,n.CE)("div",{key:2,class:(0,h.C4)(["toast",l.toast.type])},[(0,n.Lk)("i",{class:(0,h.C4)(l.toast.icon)},null,2),(0,n.eW)(" "+(0,h.v_)(l.toast.message),1)],2)):(0,n.Q3)("",!0)])}const ua={name:"Admin",data(){return{loading:!0,scenes:[],selectedScene:null,saving:!1,toast:{show:!1,type:"",message:"",icon:""}}},mounted(){this.checkAuth(),this.loadScenes()},methods:{checkAuth(){const e=localStorage.getItem("adminAuth");e||this.$router.push("/")},async loadScenes(){this.loading=!0,console.log("[FRONTEND] Inizio caricamento scene");try{const e=await I.A.get("/api/game/data");console.log("[FRONTEND] Dati ricevuti dal server:",e.data),this.scenes=e.data.scenes||[],console.log("[FRONTEND] Scene caricate:",this.scenes.length),console.log("[FRONTEND] Scene dettagli:",this.scenes.map(e=>({id:e.id,title:e.title,isFinal:e.isFinal})))}catch(e){console.error("[FRONTEND] Errore nel caricamento delle scene:",e),this.showToast("error","Errore nel caricamento delle scene","fas fa-exclamation-triangle")}finally{this.loading=!1}},selectScene(e){this.selectedScene={...e},this.selectedScene.choices||(this.selectedScene.choices=[]),void 0===this.selectedScene.isFinal&&(this.selectedScene.isFinal=!1)},addNewScene(){const e={id:Math.max(...this.scenes.map(e=>e.id),0)+1,title:"Nuova Scena",description:"",image:"",video:"",choices:[],isFinal:!1};this.scenes.push(e),this.selectScene(e)},async deleteScene(e){if(confirm("Sei sicuro di voler eliminare questa scena?"))try{await I.A.delete(`/api/admin/game/scene/${e}`),this.scenes=this.scenes.filter(a=>a.id!==e),this.selectedScene?.id===e&&(this.selectedScene=null),this.showToast("success","Scena eliminata con successo","fas fa-check")}catch(a){this.showToast("error","Errore nell'eliminazione della scena","fas fa-exclamation-triangle")}},async saveScene(){if(this.selectedScene){this.saving=!0,console.log("[FRONTEND] Inizio salvataggio scena:",this.selectedScene.id),console.log("[FRONTEND] Dati da salvare:",JSON.stringify(this.selectedScene,null,2));try{const e={...this.selectedScene},a=this.scenes.findIndex(e=>e.id===this.selectedScene.id);if(console.log("[FRONTEND] Indice scena nell'array locale:",a),-1!==a){console.log("[FRONTEND] Aggiornamento scena esistente con PUT");const s=await I.A.put(`/api/admin/game/scene/${this.selectedScene.id}`,e);console.log("[FRONTEND] Risposta PUT:",s.data),this.scenes[a]={...e}}else{console.log("[FRONTEND] Creazione nuova scena con POST");const a=await I.A.post("/api/admin/game/scene",e);console.log("[FRONTEND] Risposta POST:",a.data),a.data.scene&&a.data.scene.id&&(this.selectedScene.id=a.data.scene.id,e.id=a.data.scene.id),this.scenes.find(a=>a.id===e.id)||(this.scenes.push(e),console.log("[FRONTEND] Scena aggiunta all'array locale"))}console.log("[FRONTEND] Salvataggio completato con successo"),this.showToast("success","Scena salvata con successo","fas fa-check")}catch(e){console.error("[FRONTEND] Errore nel salvataggio:",e),console.error("[FRONTEND] Dettagli errore:",e.response?.data),this.showToast("error","Errore nel salvataggio della scena","fas fa-exclamation-triangle")}finally{this.saving=!1}}},addChoice(){this.selectedScene.choices||(this.selectedScene.choices=[]),this.selectedScene.choices.push({id:Date.now(),text:"",nextSceneId:null})},removeChoice(e){this.selectedScene.choices.splice(e,1)},async uploadImage(e){const a=e.target.files[0];if(!a)return;const s=new FormData;s.append("file",a);try{const e=await I.A.post("/api/admin/upload",s,{headers:{"Content-Type":"multipart/form-data"}});this.selectedScene.image=e.data.fileUrl,this.showToast("success","Immagine caricata con successo","fas fa-check")}catch(i){this.showToast("error","Errore nel caricamento dell'immagine","fas fa-exclamation-triangle")}},async uploadVideo(e){const a=e.target.files[0];if(!a)return;const s=new FormData;s.append("file",a);try{const e=await I.A.post("/api/admin/upload",s,{headers:{"Content-Type":"multipart/form-data"}});this.selectedScene.video=e.data.fileUrl,this.showToast("success","Video caricato con successo","fas fa-check")}catch(i){this.showToast("error","Errore nel caricamento del video","fas fa-exclamation-triangle")}},removeImage(){this.selectedScene.image=""},removeVideo(){this.selectedScene.video=""},getMediaUrl(e){return e?e.startsWith("http")?e:`${Z.API_BASE_URL}${e}`:""},previewGame(){this.$router.push("/game")},goHome(){localStorage.removeItem("adminAuth"),this.$router.push("/")},showToast(e,a,s){this.toast={show:!0,type:e,message:a,icon:s},setTimeout(()=>{this.toast.show=!1},3e3)},toggleFinalScene(){this.selectedScene.isFinal=!this.selectedScene.isFinal,this.selectedScene.isFinal&&this.selectedScene.choices&&this.selectedScene.choices.length>0&&(confirm("Rendendo questa scena finale, tutte le scelte verranno rimosse. Continuare?")?(this.selectedScene.choices=[],console.log("[FRONTEND] Scelte rimosse per scena finale:",this.selectedScene.id)):this.selectedScene.isFinal=!1)},setChoiceDestination(e,a){e.nextSceneId=a},isValidSceneId(e){return this.scenes.some(a=>a.id===e)},getSceneTitle(e){const a=this.scenes.find(a=>a.id===e);return a?a.title||"Senza titolo":"Scena non trovata"}}},ha=(0,o.A)(ua,[["render",da],["__scopeId","data-v-68aaeac4"]]),ma=ha,ga=[{path:"/",name:"Home",component:T},{path:"/game",name:"Game",component:se},{path:"/admin",name:"Admin",component:ma}],va=(0,u.aE)({history:(0,u.LA)(),routes:ga}),ka=va;I.A.defaults.baseURL=Z.API_BASE_URL;const pa=(0,i.Ef)(d);pa.config.globalProperties.$http=I.A,pa.use(ka),pa.mount("#app")}},a={};function s(i){var n=a[i];if(void 0!==n)return n.exports;var c=a[i]={exports:{}};return e[i](c,c.exports,s),c.exports}s.m=e,(()=>{var e=[];s.O=(a,i,n,c)=>{if(!i){var l=1/0;for(d=0;d<e.length;d++){for(var[i,n,c]=e[d],t=!0,o=0;o<i.length;o++)(!1&c||l>=c)&&Object.keys(s.O).every(e=>s.O[e](i[o]))?i.splice(o--,1):(t=!1,c<l&&(l=c));if(t){e.splice(d--,1);var r=n();void 0!==r&&(a=r)}}return a}c=c||0;for(var d=e.length;d>0&&e[d-1][2]>c;d--)e[d]=e[d-1];e[d]=[i,n,c]}})(),(()=>{s.d=(e,a)=>{for(var i in a)s.o(a,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a)})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};s.O.j=a=>0===e[a];var a=(a,i)=>{var n,c,[l,t,o]=i,r=0;if(l.some(a=>0!==e[a])){for(n in t)s.o(t,n)&&(s.m[n]=t[n]);if(o)var d=o(s)}for(a&&a(i);r<l.length;r++)c=l[r],s.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return s.O(d)},i=self["webpackChunkil_gioco_dei_trenta_frontend"]=self["webpackChunkil_gioco_dei_trenta_frontend"]||[];i.forEach(a.bind(null,0)),i.push=a.bind(null,i.push.bind(i))})();var i=s.O(void 0,[504],()=>s(34));i=s.O(i)})();
//# sourceMappingURL=app.dd661c96.js.map